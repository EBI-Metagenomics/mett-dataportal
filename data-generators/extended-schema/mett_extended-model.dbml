Project mett_extended_14jul2025 {
  database_type: "PostgreSQL"
}

// Genomic region: unified span-based and gene-level mapping
Table genomic_region {
  id serial [pk]
  uniprot_id text [unique]
  start integer
  end integer
  locus_tag_start text
  locus_tag_end text
  length integer
  strain_id integer [ref: > strain.id]
}

// Core species & strain info
Table species {
  id serial [pk]
  scientific_name text
  common_name text
  acronym text [unique]
  taxonomy_id integer
}

Table strain {
  id serial [pk]
  species_id integer [ref: > species.id]
  strain_id integer
  solate_name text [unique]
  assembly_name text
  assembly_accession text
  fasta_file text
  gff_file text
  type_strain boolean
}

Table strain_contigs {
  id serial [pk]
  strain_id integer [ref: > strain.id]
  seq_id text
  length integer
}

// Gene annotation
Table gene {
  id serial [pk]
  locus_tag text [unique]
  gene_id integer
  gene_name text
  alias text
  product text
  product_source text
  species_scientific_name text
  start_pos integer
  end_pos integer
  uf_ontology_terms text[]
  uf_prot_rec_fullname text
  ec_number text
  inference text
  protein_sequence text
  gene_biotype text
  strain_id integer [ref: > strain.id]
}

Table gene_dbxref {
  id serial [pk]
  gene_id integer [ref: > gene.id]
  uniprot_id text
  cog text[]
  cog_funcats text[]
  kegg text[]
  pfam text[]
  eggnog text[]
  interpro text[]
}

Table gene_ontology_terms {
  id serial [pk]
  gene_id integer [ref: > gene.id]
  ontology_type text
  ontology_id text
  ontology_description text
}

// Functional genomics and growth
Table gene_essentiality {
  id serial [pk]
  gene_id integer [ref: > gene.id]
  genomic_region_id integer [ref: > genomic_region.id]
  tas_hit double
  essentiality_call boolean
}

Table gene_fitness_data {
  id serial [pk]
  gene_id integer [ref: > gene.id]
  genomic_region_id integer [ref: > genomic_region.id]
  contrast text
  lfc double
  fdr double
}

Table gene_fitness_correlation {
  id serial [pk]
  gene1_id integer [ref: > gene.id]
  gene2_id integer [ref: > gene.id]
  genomic_region_id_1 integer [ref: > genomic_region.id]
  genomic_region_id_2 integer [ref: > genomic_region.id]
  correlation_value double [not null]
}

// Media and phenotype
Table media {
  id serial [pk]
  name text [unique, not null]
  description text
  ph double
  notes text
}

Table mutant_growth_rate {
  id serial [pk]
  gene_id integer [ref: > gene.id]
  genomic_region_id integer [ref: > genomic_region.id]
  media_id integer [ref: > media.id]
  replicate smallint
  tas_hit double
  doubling_rate_h double
}

// Drug interactions
Table drug {
  id serial [pk]
  name text [unique, not null]
  drug_class text
  drug_subclass text
  notes text
}

Table drug_bacteria_interaction {
  id serial [pk]
  strain_id integer [ref: > strain.id]
  drug_id integer [ref: > drug.id]
  pubchem_id text
  mic_um double
  drug_metabolism_percent double
  drug_metabolism_fdr double
}

Table gene_amr {
  id serial [pk]
  gene_id integer [ref: > gene.id]
  genomic_region_id integer [ref: > genomic_region.id]
  gene_symbol text
  sequence_name text
  scope text
  element_type text
  element_subtype text
  drug_id integer [ref: > drug.id]
  uf_keyword text[]
  uf_ecnumber text
}

Table protein_compound_interaction {
  id serial [pk]
  uniprot_id text
  pubchem_id text
  ttp_score double
  fdr double
  hit_calling boolean
}

Ref: protein_compound_interaction.uniprot_id > gene_dbxref.uniprot_id
Ref: protein_compound_interaction.uniprot_id > genomic_region.uniprot_id

Table ppi_interaction {
  id serial [pk]
  uniprot_id_a text
  uniprot_id_b text
  known_interaction boolean
  dl_score float
  comelt_score float
  abundance_score float
  xlms_score float
  alphafold_score float
  drugs_score float
  ensemble_score float
}

Ref: ppi_interaction.uniprot_id_a > gene_dbxref.uniprot_id
Ref: ppi_interaction.uniprot_id_b > gene_dbxref.uniprot_id

Ref: ppi_interaction.uniprot_id_a > genomic_region.uniprot_id
Ref: ppi_interaction.uniprot_id_b > genomic_region.uniprot_id
